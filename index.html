<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chat com Hugging Face</title>
  <style>
    body { font-family: sans-serif; margin: 20px; background: #f5f5f5; }
    #chat { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; background: white; }
    .user { color: blue; }
    .bot { color: green; }
    input, button, select { padding: 10px; margin-top: 10px; width: 100%; box-sizing: border-box; }
  </style>
</head>
<body>
  <h2>Chat com Hugging Face</h2>
  <label>Idioma:
    <select id="language">
      <option value="en">Inglês</option>
      <option value="es">Espanhol</option>
    </select>
  </label>
  <div id="chat"></div>
  <input type="text" id="message" placeholder="Digite sua mensagem..." />
  <button onclick="send()">Enviar</button>

  <script>
    const chatBox = document.getElementById('chat');
    const input = document.getElementById('message');
    const lang = document.getElementById('language');

    const HF_API = "https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.1"; // Modelo que suporta conversa
    const HF_TOKEN = "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";

    async function send() {
      const msg = input.value.trim();
      if (!msg) return;
      appendMessage(msg, "user");
      input.value = "";

      const prompt = lang.value === "es" ? `Responde en español: ${msg}` : `Respond in English: ${msg}`;

      appendMessage("Digitando...", "bot");

      const response = await fetch(HF_API, {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${HF_TOKEN}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ inputs: prompt })
      });

      const data = await response.json();
      const reply = data?.[0]?.generated_text?.replace(prompt, '').trim() || "Erro ao responder.";
      document.querySelectorAll(".bot").slice(-1)[0].textContent = "IA: " + reply;
    }

    function appendMessage(msg, sender) {
      const div = document.createElement("div");
      div.className = sender;
      div.textContent = (sender === "user" ? "Você: " : "IA: ") + msg;
      chatBox.appendChild(div);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    input.addEventListener("keypress", function(e) {
      if (e.key === "Enter") send();
    });
  </script>
</body>
</html>
